// Ion.Sound | version 2.1.1 | https://github.com/IonDen/ion.sound
var ion=ion||{};(function(c){var g=function(a){a&&console&&(console.warn&&"function"===typeof console.warn?console.warn(a):console.log&&"function"===typeof console.log&&console.log(a))};if(c.sound)g("ion.sound already exists!");else if("function"!==typeof Audio&&"object"!==typeof Audio){var f=function(){g("HTML5 Audio is not supported in this browser")};c.sound=function(){};c.sound.play=f;c.sound.stop=f;c.sound.destroy=f;f()}else{var e={},b={},h,k,d,l=function(a){this.name=a.name;this.volume=e.volume||.5;this.preload=e.preload?"auto":"none";this.paused=this.loop=!1;this.callback=this.sound=null;"volume"in a&&(this.volume=+a.volume);"preload"in a&&(this.preload=a.preload?"auto":"none")};l.prototype={init:function(){this.sound=new Audio;this.sound.src=e.path+this.name+k;this.sound.load();this.sound.preload=this.preload;this.sound.volume=this.volume;this.sound.addEventListener("ended",this._ended.bind(this),!1)},play:function(a){a||(a={});if(a.volume||0===a.volume)this.volume=+a.volume,this.sound.volume=this.volume;a.loop?this.paused?this._playLoop(this.loop+1):this._playLoop(a.loop):(this.loop=!1,this._play());a.onEnded&&"function"===typeof a.onEnded&&(this.callback=a.onEnded)},_play:function(){if(this.paused)this.paused=!1;else try{this.sound.currentTime=0}catch(a){}this.sound.play()},_playLoop:function(a){"boolean"===typeof a?(this.loop=9999999,this._play()):"number"===typeof a&&(this.loop=a-1,this._play())},_ended:function(){0<this.loop&&(--this.loop,this._play());this.callback&&this.callback(this.name)},pause:function(){this.paused=!0;this.sound.pause()},stop:function(){this.loop=!1;this.sound.pause();try{this.sound.currentTime=0}catch(a){}},destroy:function(){this.stop();this.sound.removeEventListener("ended",this._ended.bind(this),!1);this.sound.src="";this.sound=null}};c.sound=function(a){e=JSON.parse(JSON.stringify(a));e.path=e.path||"";e.volume=e.volume||.5;e.preload=e.preload||!1;e.mix=e.mix||!0;if(h=e.sounds.length){var c=new Audio;a=c.canPlayType("audio/mpeg");var f=c.canPlayType("audio/ogg; codecs='vorbis'"),c=c.canPlayType("audio/mp4; codecs='mp4a.40.2'");k="probably"===a?".mp3":"probably"===c?".aac":"probably"===f?".ogg":"maybe"===c?".aac":"maybe"===a?".mp3":"maybe"===f?".ogg":".wav";for(d=0;d<h;d++)a=e.sounds[d],b[a.name]=new l(a),b[a.name].init()}else g("No sound-files provided!")};c.sound.version="2.0.2";c.sound.play=function(a,c){b[a]&&b[a].play(c)};c.sound.pause=function(a){if(a&&b[a])b[a].pause();else for(d in b)b.hasOwnProperty(d)&&b[d]&&b[d].pause()};c.sound.stop=function(a){if(a&&b[a])b[a].stop();else for(d in b)b.hasOwnProperty(d)&&b[d]&&b[d].stop()};c.sound.destroy=function(a){if(a&&b[a])b[a].destroy(),b[a]=null;else for(d in b)b.hasOwnProperty(d)&&b[d]&&(b[d].destroy(),b[d]=null)}}})(ion);
